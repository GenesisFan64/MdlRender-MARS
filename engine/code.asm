; ====================================================================
; ----------------------------------------------------------------
; CODE Section
; 
; MCD: $FF0000
; MARS: $880000
; ----------------------------------------------------------------

Engine_Code:

; --------------------------------------------------------
; Subroutines
; --------------------------------------------------------

		include	"system/md/system.asm"
		include	"system/md/video.asm"
		include	"system/md/sound.asm"
		include	"engine/global.asm"

; ====================================================================
; --------------------------------------------------------
; INIT
; --------------------------------------------------------

MD_Main:
		bsr 	Sound_init
		bsr 	Video_init
		bsr	System_Init

; ====================================================================
; --------------------------------------------------------
; Main loop
; --------------------------------------------------------

ModeLoop:
		move.w	(RAM_GameMode),d0
		add.w	d0,d0
		move.w	.list(pc,d0.w),d1
		jsr	.list(pc,d1.w)
		bra.s	ModeLoop

; ====================================================================
; --------------------------------------------------------
; GAME MODES section
; --------------------------------------------------------

.list:
		dc.w GmMode_0-.list
		
; ------------------------------------------------
; MARS
; ------------------------------------------------

	if MARS
		include "engine/modes/title/mars/code.asm"

; ------------------------------------------------
; MD/MCD
; ------------------------------------------------

	else
		include "engine/modes/title/md_mcd/code.asm"

; ------------------------------------------------

	endif
	
; ====================================================================

Engine_Code_end:
	if MOMPASS=7
		message "MD CODE uses: \{Engine_Code_end-Engine_Code}"
	endif
