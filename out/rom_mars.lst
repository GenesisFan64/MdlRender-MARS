 AS V1.42 Beta [Bld 118] - source file mars.asm - page 1 - 9/19/2019 22:05:38


       1/       0 :                     ; ===========================================================================
       2/       0 :                     ; +-----------------------------------------------------------------+
       3/       0 :                     ; UNTITLED GAME PROJECT
       4/       0 :                     ; (C)Kevin C. "GenesisFan64"
       5/       0 :                     ; 
       6/       0 :                     ; 32X version
       7/       0 :                     ; 
       8/       0 :                     ; Started on 6/November/2018
       9/       0 :                     ; +-----------------------------------------------------------------+
      10/       0 :                     
      11/       0 :                     		include	"system/macros.asm"	; Assembler macros
(1)    1/       0 :                     ; ===========================================================================
(1)    2/       0 :                     ; ----------------------------------------------------------------
(1)    3/       0 :                     ; MACROS
(1)    4/       0 :                     ; ----------------------------------------------------------------
(1)    5/       0 :                     
(1)    6/       0 :                     ; --------------------------------------------------------
(1)    7/       0 :                     ; AS Main settings
(1)    8/       0 :                     ; --------------------------------------------------------
(1)    9/       0 :                     
(1)   10/       0 :                     		!org 0				; Start at 0
(1)   11/       0 :                     		cpu 		68000		; BASE CPU is 68k (manually changed later)
(1)   12/       0 :                     		padding		off		; Dont pad dc.b
(1)   13/       0 :                     		listing 	purecode	; Want listing file, but only the final code in expanded macros
(1)   14/       0 :                     		supmode 	on 		; Supervisor mode
(1)   15/       0 :                     		dottedstructs	off		; If needed
(1)   16/       0 :                     		page 		0
(1)   17/       0 :                     
(1)   18/       0 :                     ; ====================================================================
(1)   19/       0 :                     ; ---------------------------------------------
(1)   20/       0 :                     ; Functions
(1)   21/       0 :                     ; ---------------------------------------------
(1)   22/       0 :                     
(1)   23/       0 :                     doubleword 	function l,r,(l<<16&$FFFF0000|r&$FFFF)				; LLLL RRRR
(1)   24/       0 :                     
(1)   25/       0 :                     mapsize		function l,r,( ((l-1)/8)<<16&$FFFF0000|((r-1)/8)&$FFFF )	; for cell w/h use doubleword
(1)   26/       0 :                     locate		function a,b,c,(c&$FF)|(b<<8&$FF00)|(a<<16&$FF0000)		; Layer|X pos|Y pos for some video routines
(1)   27/       0 :                     
(1)   28/       0 :                     ; ====================================================================
(1)   29/       0 :                     ; ---------------------------------------------
(1)   30/       0 :                     ; Macros
(1)   31/       0 :                     ; ---------------------------------------------
(1)   32/       0 :                     
(1)   33/       0 :                     ; -------------------------------------
(1)   34/       0 :                     ; Reserve memory space
(1)   35/       0 :                     ; -------------------------------------
(1)   36/       0 :                     
(1)   37/       0 :                     struct		macro thisinput			; Reserve memory address
(1)   38/       0 :                     GLBL_LASTPC	set *
(1)   39/       0 :                     		dephase
(1)   40/       0 :                     GLBL_LASTORG	set *
(1)   41/       0 :                     		phase thisinput
(1)   42/       0 :                     		endm
(1)   43/       0 :                     		
(1)   44/       0 :                     ; -------------------------------------
(1)   45/       0 :                     ; Finish
(1)   46/       0 :                     ; -------------------------------------
(1)   47/       0 :                     
(1)   48/       0 :                     finish		macro				; Then finish
(1)   49/       0 :                     		!org GLBL_LASTORG
(1)   50/       0 :                     		phase GLBL_LASTPC
(1)   51/       0 :                     		endm
(1)   52/       0 :                     
(1)   53/       0 :                     ; -------------------------------------
(1)   54/       0 :                     ; ZERO Fill padding
(1)   55/       0 :                     ; -------------------------------------
(1)   56/       0 :                     
(1)   57/       0 :                     rompad		macro address			; Zero fill
(1)   58/       0 :                     diff := address - *
(1)   59/       0 :                     		if diff < 0
(1)   60/       0 :                     			error "too much stuff before org $\{address} ($\{(-diff)} bytes)"
(1)   61/       0 :                     		else
(1)   62/       0 :                     			while diff > 1024
(1)   63/       0 :                     				; AS can only generate 1 kb of code on a single line
(1)   64/       0 :                     				dc.b [1024]0
(1)   65/       0 :                     diff := diff - 1024
(1)   66/       0 :                     			endm
(1)   67/       0 :                     			dc.b [diff]0
(1)   68/       0 :                     		endif
(1)   69/       0 :                     	endm
(1)   70/       0 :                     	
(1)   71/       0 :                     ; -------------------------------------
(1)   72/       0 :                     ; ORG
(1)   73/       0 :                     ;
(1)   74/       0 :                     ; (from s2disasm)
(1)   75/       0 :                     ; -------------------------------------
(1)   76/       0 :                     
(1)   77/       0 : =$0                 paddingSoFar set 0
(1)   78/       0 :                     ; 128 = 80h = z80, 32988 = 80DCh = z80unDoC 
(1)   79/       0 :                     notZ80 function cpu,(cpu<>128)&&(cpu<>32988)
(1)   80/       0 :                     
(1)   81/       0 :                     ; make org safer (impossible to overwrite previously assembled bytes) and count padding
(1)   82/       0 :                     ; and also make it work in Z80 code without creating a new segment
(1)   83/       0 :                     org macro address
(1)   84/       0 :                     	if notZ80(MOMCPU)
(1)   85/       0 :                     		if address < *
(1)   86/       0 :                     			error "too much stuff before org $\{address} ($\{(*-address)} bytes)"
(1)   87/       0 :                     		elseif address > *
(1)   88/       0 :                     paddingSoFar	set paddingSoFar + address - *
(1)   89/       0 :                     			!org address
(1)   90/       0 :                     		endif
(1)   91/       0 :                     	else
(1)   92/       0 :                     		if address < $
(1)   93/       0 :                     			error "too much stuff before org 0\{address}h (0\{($-address)}h bytes)"
(1)   94/       0 :                     		else
(1)   95/       0 :                     			while address > $
(1)   96/       0 :                     				db 0
(1)   97/       0 :                     			endm
(1)   98/       0 :                     		endif
(1)   99/       0 :                     	endif
(1)  100/       0 :                         endm
(1)  101/       0 :                     
(1)  102/       0 :                     ; ====================================================================
(1)  103/       0 :                     ; ---------------------------------------------
(1)  104/       0 :                     ; Mega CD only
(1)  105/       0 :                     ; ---------------------------------------------
(1)  106/       0 :                     
(1)  107/       0 :                     ; Set a ISO file
(1)  108/       0 :                     ; NOTE: a valid ISO head is required ($8000 to $B7FF)
(1)  109/       0 :                     
(1)  110/       0 :                     iso_setfs	macro type,start,end
(1)  111/       0 :                     .fstrt:		dc.b .fend-.fstrt				; Block size
(1)  112/       0 :                     		dc.b 0						; zero
(1)  113/       0 :                     		dc.b (start>>11&$FF),(start>>19&$FF)		; Start sector, little
(1)  114/       0 :                     		dc.b (start>>27&$FF),(start>>35&$FF)
(1)  115/       0 :                     		dc.l start>>11					; Start sector, big
(1)  116/       0 :                     		dc.b ((end-start)&$FF),((end-start)>>8&$FF)	; Filesize, little
(1)  117/       0 :                     		dc.b ((end-start)>>16&$FF),((end-start)>>24&$FF)
(1)  118/       0 :                     		dc.l end-start					; Filesize, big
(1)  119/       0 :                     		dc.b (2018-1900)+1				; Year
(1)  120/       0 :                     		dc.b 0,0,0,0,0,0				; TODO
(1)  121/       0 :                     		dc.b 2						; File flags
(1)  122/       0 :                     		dc.b 0,0
(1)  123/       0 :                     		dc.b 1,0					; Volume sequence number, little
(1)  124/       0 :                     		dc.b 0,1					; Volume sequence number, big
(1)  125/       0 :                     		dc.b 1,type
(1)  126/       0 :                     .fend:
(1)  127/       0 :                     		endm
(1)  128/       0 :                     		
(1)  129/       0 :                     iso_file	macro filename,start,end
(1)  130/       0 :                     .fstrt:		dc.b .fend-.fstrt				; Block size
(1)  131/       0 :                     		dc.b 0						; zero
(1)  132/       0 :                     		dc.b (start>>11&$FF),(start>>19&$FF)		; Start sector, little
(1)  133/       0 :                     		dc.b (start>>27&$FF),(start>>35&$FF)
(1)  134/       0 :                     		dc.l start>>11					; Start sector, big
(1)  135/       0 :                     		dc.b ((end-start)&$FF),((end-start)>>8&$FF)	; Filesize, little
(1)  136/       0 :                     		dc.b ((end-start)>>16&$FF),((end-start)>>24&$FF)
(1)  137/       0 :                     		dc.l end-start					; Filesize, big
(1)  138/       0 :                     		dc.b (2018-1900)+1				; Year
(1)  139/       0 :                     		dc.b 0,0,0,0,0,0				; TODO
(1)  140/       0 :                     		dc.b 0						; File flags
(1)  141/       0 :                     		dc.b 0,0
(1)  142/       0 :                     		dc.b 1,0					; Volume sequence number, little
(1)  143/       0 :                     		dc.b 0,1					; Volume sequence number, big
(1)  144/       0 :                     		dc.b .flend-.flen
(1)  145/       0 :                     .flen:		dc.b filename,";1"
(1)  146/       0 :                     .flend:		dc.b 0
(1)  147/       0 :                     .fend:
(1)  148/       0 :                     		endm
(1)  149/       0 :                     		
(1)  150/       0 :                     ; ====================================================================
(1)  151/       0 :                     ; ---------------------------------------------
(1)  152/       0 :                     ; 32X only
(1)  153/       0 :                     ; ---------------------------------------------
(1)  154/       0 :                     
      12/       0 :                     		include	"system/const.asm"	; RAM / Variables are here
(1)    1/       0 :                     ; ====================================================================
(1)    2/       0 :                     ; ----------------------------------------------------------------
(1)    3/       0 :                     ; Engine settings
(1)    4/       0 :                     ; ----------------------------------------------------------------
(1)    5/       0 :                     
(1)    6/       0 : =$FFFF8800          MDRAM_START	equ $FFFF8800	; Start of working RAM (below is free)
(1)    7/       0 : =$800               MAX_MDERAM	equ $800	; MAX RAM for Screen modes
(1)    8/       0 :                     
(1)    9/       0 :                     ; ====================================================================
(1)   10/       0 :                     ; ----------------------------------------------------------------
(1)   11/       0 :                     ; Variables
(1)   12/       0 :                     ; ----------------------------------------------------------------
(1)   13/       0 :                     
(1)   14/       0 :                     ; --------------------------------------------------------
(1)   15/       0 :                     ; System
(1)   16/       0 :                     ; --------------------------------------------------------
(1)   17/       0 :                     
(1)   18/       0 :                     ; ------------------------------------------------
(1)   19/       0 :                     ; vdp_ctrl READ bits
(1)   20/       0 :                     ; ------------------------------------------------
(1)   21/       0 :                     
(1)   22/       0 : =$2                 bitHint		equ 2
(1)   23/       0 : =$3                 bitVint		equ 3
(1)   24/       0 : =$1                 bitDma		equ 1
(1)   25/       0 :                     
(1)   26/       0 :                     ; ------------------------------------------------
(1)   27/       0 :                     ; VDP register variables
(1)   28/       0 :                     ; ------------------------------------------------
(1)   29/       0 :                     
(1)   30/       0 :                     ; Register $80
(1)   31/       0 : =$2                 HVStop		equ $02
(1)   32/       0 : =$10                HintEnbl	equ $10
(1)   33/       0 : =$1                 bitHVStop	equ 1
(1)   34/       0 : =$4                 bitHintEnbl	equ 4
(1)   35/       0 :                     
(1)   36/       0 :                     ; Register $81
(1)   37/       0 : =$40                DispEnbl 	equ $40
(1)   38/       0 : =$20                VintEnbl 	equ $20
(1)   39/       0 : =$10                DmaEnbl		equ $10
(1)   40/       0 : =$6                 bitDispEnbl	equ 6
(1)   41/       0 : =$5                 bitVintEnbl	equ 5
(1)   42/       0 : =$4                 bitDmaEnbl	equ 4
(1)   43/       0 : =$3                 bitV30		equ 3
(1)   44/       0 :                     	
(1)   45/       0 :                     ; --------------------------------------------------------
(1)   46/       0 :                     ; System section
(1)   47/       0 :                     ; --------------------------------------------------------
(1)   48/       0 :                     
(1)   49/       0 : =$1                 JoyUp		equ $0001
(1)   50/       0 : =$2                 JoyDown		equ $0002
(1)   51/       0 : =$4                 JoyLeft		equ $0004
(1)   52/       0 : =$8                 JoyRight	equ $0008
(1)   53/       0 : =$10                JoyB		equ $0010
(1)   54/       0 : =$20                JoyC		equ $0020
(1)   55/       0 : =$40                JoyA		equ $0040
(1)   56/       0 : =$80                JoyStart	equ $0080
(1)   57/       0 : =$100               JoyZ		equ $0100
(1)   58/       0 : =$200               JoyY		equ $0200
(1)   59/       0 : =$400               JoyX		equ $0400
(1)   60/       0 : =$800               JoyMode		equ $0800
(1)   61/       0 :                     
(1)   62/       0 :                     ; right byte only
(1)   63/       0 : =$0                 bitJoyUp	equ 0
(1)   64/       0 : =$1                 bitJoyDown	equ 1
(1)   65/       0 : =$2                 bitJoyLeft	equ 2
(1)   66/       0 : =$3                 bitJoyRight	equ 3
(1)   67/       0 : =$4                 bitJoyB		equ 4
(1)   68/       0 : =$5                 bitJoyC		equ 5
(1)   69/       0 : =$6                 bitJoyA		equ 6
(1)   70/       0 : =$7                 bitJoyStart	equ 7
(1)   71/       0 :                     
(1)   72/       0 :                     ; left byte only
(1)   73/       0 : =$0                 bitJoyZ		equ 0
(1)   74/       0 : =$1                 bitJoyY		equ 1
(1)   75/       0 : =$2                 bitJoyX		equ 2
(1)   76/       0 : =$3                 bitJoyMode	equ 3
(1)   77/       0 :                     
(1)   78/       0 :                     ; --------------------------------------------------------
(1)   79/       0 :                     
(1)   80/       0 :                     ; Special:
(1)   81/       0 :                     ; MCD already jumps to RAM
(1)   86/       0 :                     RAM_VBlankGoTo	equ RAM_MdMarsVInt
(1)   87/       0 :                     RAM_HBlankGoTo	equ RAM_MdMarsHInt
(1)   89/       0 :                     
(1)   90/       0 :                     ; --------------------------------------------------------
(1)   91/       0 :                     ; Misc
(1)   92/       0 :                     ; --------------------------------------------------------
(1)   93/       0 :                     
(1)   94/       0 :                     ; RAM_SysFlags
(1)   95/       0 : =$0                 bitMars		equ 0
(1)   96/       0 :                     
(1)   97/       0 : =$7FF               varNullVram	equ $7FF
(1)   98/       0 :                     
(1)   99/       0 :                     ; ====================================================================
(1)  100/       0 :                     ; ----------------------------------------------------------------
(1)  101/       0 :                     ; Aliases
(1)  102/       0 :                     ; ----------------------------------------------------------------
(1)  103/       0 :                     
(1)  104/       0 :                     Controller_1	equ RAM_InputData
(1)  105/       0 :                     Controller_2	equ RAM_InputData+sizeof_input
(1)  106/       0 :                     
(1)  107/       0 : =$C0000000          Vdp_palette	equ $C0000000		; Palette
(1)  108/       0 : =$40000010          Vdp_vsram	equ $40000010		; Vertical scroll
(1)  109/       0 :                     
(1)  110/       0 :                     ; ====================================================================
(1)  111/       0 :                     ; ----------------------------------------------------------------
(1)  112/       0 :                     ; Structures
(1)  113/       0 :                     ; ----------------------------------------------------------------
(1)  114/       0 :                     
(1)  115/       0 :                     ; Controller
(1)  116/       0 : (MACRO)             		struct 0
(1)  116/       0 : =$0                 GLBL_LASTPC     set *
(1)  116/       0 :                                     dephase
(1)  116/       0 : =$0                 GLBL_LASTORG    set *
(1)  116/       0 :                                     phase 0
(1)  117/       0 :                     pad_id		ds.b 1
(1)  118/       1 :                     pad_ver		ds.b 1
(1)  119/       2 :                     on_hold		ds.w 1
(1)  120/       4 :                     on_press	ds.w 1
(1)  121/       6 :                     sizeof_input	ds.l 0
(1)  122/       8 : (MACRO)             		finish
(1)  122/       0 :                                     !org GLBL_LASTORG
(1)  122/       0 :                                     phase GLBL_LASTPC
(1)  123/       0 :                     
(1)  124/       0 :                     ; ====================================================================
(1)  125/       0 :                     ; ----------------------------------------------------------------
(1)  126/       0 :                     ; MD RAM
(1)  127/       0 :                     ;
(1)  128/       0 :                     ; NOTE:
(1)  129/       0 :                     ; MCD Uses $FFFD00-$FFFDFF, stack starts at $FFFD00
(1)  130/       0 :                     ; ----------------------------------------------------------------
(1)  131/       0 :                     
(1)  132/       0 : (MACRO)             		struct MDRAM_START
(1)  132/       0 : =$0                 GLBL_LASTPC     set *
(1)  132/       0 :                                     dephase
(1)  132/       0 : =$0                 GLBL_LASTORG    set *
(1)  132/FFFFFFFFFFFF8800 :                                     phase MDRAM_START
(1)  134/FFFFFFFFFFFF8800 :                     RAM_ModeBuff	ds.l 0
(1)  135/FFFFFFFFFFFF8800 :                     RAM_Global	ds.l 0
(1)  136/FFFFFFFFFFFF8800 :                     RAM_MdSystem	ds.l 0
(1)  137/FFFFFFFFFFFF8800 :                     RAM_MdSound	ds.l 0
(1)  138/FFFFFFFFFFFF8800 :                     RAM_MdVideo	ds.l 0
(1)  139/FFFFFFFFFFFF8800 :                     RAM_ExRamSub	ds.l 0
(1)  140/FFFFFFFFFFFF8800 :                     sizeof_mdram	ds.l 0
(1)  150/FFFFFFFFFFFF8800 :                     	
(1)  154/FFFFFFFFFFFF8800 : (MACRO)             		finish
(1)  154/FFFFFFFFFFFF8800 :                                     !org GLBL_LASTORG
(1)  154/       0 :                                     phase GLBL_LASTPC
(1)  155/       0 :                     
(1)  156/       0 :                     ; ====================================================================
(1)  157/       0 :                     ; ----------------------------------------------------------------
(1)  158/       0 :                     ; System RAM
(1)  159/       0 :                     ; ----------------------------------------------------------------
(1)  160/       0 :                     
(1)  161/       0 : (MACRO)             		struct RAM_MdSystem
(1)  161/       0 : =$0                 GLBL_LASTPC     set *
(1)  161/       0 :                                     dephase
(1)  161/       0 : =$0                 GLBL_LASTORG    set *
(1)  161/FFFFFFFFFFFF8800 :                                     phase RAM_MDSYSTEM
(1)  162/FFFFFFFFFFFF8800 :                     RAM_InputData	ds.b sizeof_input*4
(1)  163/FFFFFFFFFFFF8818 :                     RAM_SaveData	ds.b $200		; TODO: save data copy
(1)  164/FFFFFFFFFFFF8A18 :                     RAM_FrameCount	ds.l 1
(1)  165/FFFFFFFFFFFF8A1C :                     RAM_SysRandVal	ds.l 1
(1)  166/FFFFFFFFFFFF8A20 :                     RAM_SysRandSeed	ds.l 1
(1)  167/FFFFFFFFFFFF8A24 :                     RAM_initflug	ds.l 1
(1)  168/FFFFFFFFFFFF8A28 :                     RAM_GameMode	ds.w 1			; Master game mode
(1)  169/FFFFFFFFFFFF8A2A :                     RAM_SysFlags	ds.w 1			; (byte)
(1)  171/FFFFFFFFFFFF8A2C :                     RAM_MdMarsVInt	ds.w 3			; MD/MARS ONLY: JMP xxxx xxxx
(1)  172/FFFFFFFFFFFF8A32 :                     RAM_MdMarsHint	ds.w 3			; MD/MARS ONLY: JMP xxxx xxxx
(1)  174/FFFFFFFFFFFF8A38 :                     sizeof_mdsys	ds.l 0
(1)  175/FFFFFFFFFFFF8A38 : (MACRO)             		finish
(1)  175/FFFFFFFFFFFF8800 :                                     !org GLBL_LASTORG
(1)  175/       0 :                                     phase GLBL_LASTPC
(1)  176/       0 :                     
(1)  177/       0 :                     ; ====================================================================
(1)  178/       0 :                     ; ----------------------------------------------------------------
(1)  179/       0 :                     ; Sound 68k RAM
(1)  180/       0 :                     ; ----------------------------------------------------------------
(1)  181/       0 :                     
(1)  182/       0 :                     	; 68k side
(1)  183/       0 : (MACRO)             		struct RAM_MdSound
(1)  183/       0 : =$0                 GLBL_LASTPC     set *
(1)  183/       0 :                                     dephase
(1)  183/       0 : =$0                 GLBL_LASTORG    set *
(1)  183/FFFFFFFFFFFF8800 :                                     phase RAM_MDSOUND
(1)  184/FFFFFFFFFFFF8800 :                     RAM_SoundTemp	ds.l 1
(1)  185/FFFFFFFFFFFF8804 :                     sizeof_mdsnd	ds.l 0
(1)  186/FFFFFFFFFFFF8804 : (MACRO)             		finish
(1)  186/FFFFFFFFFFFF8800 :                                     !org GLBL_LASTORG
(1)  186/       0 :                                     phase GLBL_LASTPC
(1)  187/       0 :                     		
(1)  188/       0 :                     	; Z80 side
(1)  189/       0 : (MACRO)             		struct $800
(1)  189/       0 : =$0                 GLBL_LASTPC     set *
(1)  189/       0 :                                     dephase
(1)  189/       0 : =$0                 GLBL_LASTORG    set *
(1)  189/     800 :                                     phase $800
(1)  190/     800 :                     sndWavStart	ds.b 2		; Start address (inside or outside z80)
(1)  191/     802 :                     sndWavStartB	ds.b 1		; Start ROM bank * 8000h 
(1)  192/     803 :                     sndWavEnd	ds.b 2		; End address
(1)  193/     805 :                     sndWavEndB	ds.b 1		; End ROM bank *8000h
(1)  194/     806 :                     sndWavLoop	ds.b 2		; Loop address
(1)  195/     808 :                     sndWavLoopB	ds.b 1		; Loop ROM Bank * 8000h
(1)  196/     809 :                     sndWavPitch	ds.b 2		; pitch speed
(1)  197/     80B :                     sndWavFlags	ds.b 1		; playback flags
(1)  198/     80C :                     sndWavReq	ds.b 1		; request byte
(1)  199/     80D : (MACRO)             		finish
(1)  199/     800 :                                     !org GLBL_LASTORG
(1)  199/       0 :                                     phase GLBL_LASTPC
(1)  200/       0 :                     		
(1)  201/       0 :                     ; ====================================================================
(1)  202/       0 :                     ; ----------------------------------------------------------------
(1)  203/       0 :                     ; Video RAM
(1)  204/       0 :                     ; ----------------------------------------------------------------
(1)  205/       0 :                     
(1)  206/       0 : (MACRO)             		struct RAM_MdVideo
(1)  206/       0 : =$0                 GLBL_LASTPC     set *
(1)  206/       0 :                                     dephase
(1)  206/       0 : =$0                 GLBL_LASTORG    set *
(1)  206/FFFFFFFFFFFF8800 :                                     phase RAM_MDVIDEO
(1)  207/FFFFFFFFFFFF8800 :                     RAM_VidPrntVram	ds.w 1
(1)  208/FFFFFFFFFFFF8802 :                     RAM_VidPrntList	ds.w 3*64		; vdp addr (LONG), type (WORD)
(1)  209/FFFFFFFFFFFF8982 :                     RAM_VdpRegs	ds.b 24
(1)  210/FFFFFFFFFFFF899A :                     sizeof_mdvid	ds.l 0
(1)  211/FFFFFFFFFFFF899C : (MACRO)             		finish
(1)  211/FFFFFFFFFFFF8800 :                                     !org GLBL_LASTORG
(1)  211/       0 :                                     phase GLBL_LASTPC
(1)  212/       0 :                     
